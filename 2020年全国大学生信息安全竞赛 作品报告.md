# 2020年全国大学生信息安全竞赛作品报告

作品名称：基于CNN神经网络的异常流量嗅探与分类系统
电子邮箱：
提交日期：
填写说明：

1. 所有参赛项目必须为一个基本完整的设计。作品报告书旨在能够清晰准确地阐述（或图示）该参赛队的参赛项目（或方案）。
2. 作品报告采用A4纸撰写。除标题外，所有内容必需为宋体、小四号字、1.5倍行距。
3. 作品报告中各项目说明文字部分仅供参考，作品报告书撰写完毕后，请删除所有说明文字。(本页不删除)
4. 作品报告模板里已经列的内容仅供参考，作者可以在此基础上增加内容或对文档结构进行微调。
5. 为保证网评的公平、公正，作品报告中应避免出现作者所在学校、院系和指导教师等泄露身份的信息。

## 摘要

//（请简要说明创作本作品之动机、功能、特性、创新处、实用性）

现有的流量获取、处理、攻击分析的工作都在各自领域有较深入的进展和成果，但在整合整个分析流程，带来更好的更完善的用户体验方面仍有欠缺。同时，市面上已有的流量检测软件的原理，大部分是基于模式识别，通过不断更新黑名单实现对异常流量的识别，这对软件的后续维护及时更新提出了较高的要求。

神经网络在流量识别领域已经有了一定程度的实践，而实践的起点基本都是权威机构公开的流量数据集，本项目设想在已有的学术实践的基础上更进一步，完整实现用神经网络对真实流量嗅探与分类的全过程，并且用多样的可视化方式将检测结果提供给使用者，带来更好的使用体验。

核心功能：对特定站点的流量，运用简易的深度学习网络进行判别，最后提供可视化分析结果

创新处：从流量分类原理的角度，本项目的创新之处是使用了区别于常规的流量分类所采用的模式识别的方法，将深度学习理念融合到实际流量分类应用场景中。从产品功能角度来看，本项目利用神经网络原理学习流量特征，将流量获取处理、神经网络与可视化进行整合，以图文结合的形式给出了流量具体数据，类型预测结果以及发送接收方地理位置显示。同时对神经网络数据来源进行推广，从单一数据集到实时数据的获取。

实用性：支持实时获取流量以及导入流量数据两种分析方式，支持多种场景下的应用，例如网络攻防实战中的实时监测，数据集数据的导入式分析等等。同时经过神经网络判别后也能得到准确率较高的的可视化结果并提供其他信息以辅助分析。

## 第一章 作品概述

//（建议包括：背景分析、相关工作、特色描述及应用前景分析等）

背景分析
 // 运用深度学习进行流量分析已有许多实践，其中CNN网络有突出的效果

随着网络规模的不断扩大与人们生产生活对网络依赖的提高，各类网络攻击活动日渐猖獗，导致网络性能下降甚至不可使用，给人们的网络生活带来了较大的困扰。同时，为了更好的应对网络攻击，人们也在不断地进行网络攻防的演练以及已有流量数据集的深入分析，试图以主动的方式得到更好的防御方案。基于此，能够更加准确的判断流量类型，能够提供更详细，更直观的流量数据的软件的需求呼声越来越高。

近年来，市面上也出现了一些流量监测软件，他们大多基于模式识别方式，依赖黑名单数据库对异常流量进行识别。而这一方面需要不断对软件数据库进行维护，将新产生的攻击模式加入数据库中，将浪费极大的人力同时一旦不再更新，软件将逐渐不再能够检测层出不穷的新型攻击。另一方面，固定的黑名单对新出现的恶意流量的泛化能力弱，不适应现今新型攻击层出不穷的状况。同时，各检测软件都有自己侧重的功能亮点从而也产生了弱势点，或注重全面体验而弱化具体流量分析从而不适用于侧重分析的生产研究活动；或忽视了可视化设计降低了用户体验……产生了分析流量可能需要几款不同软件才能满足数据深入度与体验感均较高的需求的状况。

在这个”头脑的社会“，作为人工智能技术朝新方向迈出的第一步，深度学习构建了能够模仿人类大脑行为的神经网络。这些多层次的网络像人类大脑一样， 可以收集信息，并基于收集到的信息产生相应的行为，这使得这个系统可以”自己学会世界上的一些概念“，而这也是深度学习区别于其他技术的亮点，其积累学习，提取特征的能力让其在现今知识技术高速更新的各行各业脱颖而出。而网络攻击的重要特征便是新的攻击类型不断出现，普通的黑名单式累加显然处于被动地位，而深度学习的泛化能力让其基于现有的数据对将来可能出现的新数据有一定的判断能力，恰好符合了流量监测软件的技术需求，可见，未来深度学习技术在流量监测软件上的应用将成为一大趋势。在深度学习中，卷积神经网络结构可以保留邻域的联系和空间的局部特点，这符合网络流量的包内与包间联系特点，同时多层结构在更高层凸显输入中的重要方面，同时能在遇到更不重要的变化时变得越来越稳健。这些优势使得CNN十分适合应用于网络流量监测。

基于以上背景，本项目使用经过设计调整的卷积神经网络作为检测内核，将流量的具体信息例如源，目标地址，地理位置，协议等信息通过图文的方式呈现，以供分析者参考。同时，支持流量实时分析与数据集分析，方便多种研究模式。

###### 相关工作

 // 类似流量检测研究：

针对核心检测部分，项目成员通过阅读文献深入理解了深度学习的工作机理以及应用优势，经过与其他检测机制的对比，确定了以神经网络作为检测核心。而在深度学习的几种网络结构中，通过前人研究工作检索了解了卷积神经网络局部感受野，权值共享等本次应用中较为优势之处并进行网络结构实际搭建之后通过一定的训练对比，选择卷积神经网络。

  //同类流量检测软件：https://www.glasswire.com

为更好地提升网络流量监测的体验，项目成员对现有监测软件进行了体验分析。

其中面向普通用户的glasswire，360在检测软件市场中所占份额较大，以其全面的监控以及舒适的界面体验脱颖而出。但由于更加注重全面防护全面检测的定位让他们弱化了提供更加详细的流量分析这一更专业人员需要的功能。无法清晰的体现流量检测的过程，同时隐藏检测过程使得用户也很难直观感受到软件检测的效果.这便出现了较专业用户需求这一缺口，全面的防护分析在专业研究中反而失去了实用性，需要有更加有针对性的分析软件。这为我们的开发思路提供了借鉴。

###### 特色描述

由于全面防护软件已十分成熟，本项目软件更加注重于对流量数据的分析显示，通过数据和图像相结合的方式清晰的体现了流量的具体信息与预测结果，方便研究人员的使用。同时，经过训练的卷积神经网络的内核具有较好的泛化能力使得本产品可以更好地适应恶意流量不断推陈出新的现状，降低了维护成本，成为研究分析过程中更为可靠的工具。

###### 应用前景分析

随着网络技术的不断进步，对流量的研究工作必将不断进行越来越深入，而一款轻便的，检测技术先进的数据分析软件必将在科研领域有较好的应用前景。同时，未来发展中，民众的网络知识能力必将不断提高，更多的兴趣爱好者将投身于网络安全研究中，对网络流量深入了解的需求也将随之不断增长，而提供流量具体信息的软件将成为他们打开信息安全大门，深入了解网络世界的一大助力。

本项目开发的软件定位于辅助流量分析，适用于生活中的流量兴趣分析，攻防实战中的实时流量分析，收集数据集之后的深入分析等多种应用场景，通过图文相辅的显示方式致力于更加直观迅速的提供检测结果与分析数据，提高研究人员的分析效率。这在未来不断深入底层的研究中将更加符合需求，从而将有持续的需求市场。

  

## 第二章 作品设计与实现

第一：随着全球网络威胁不断出现新的变化，新型的网络攻击层出不穷，因此，利用算法实现网络异常行为的分析监测就具有了研究意义。

第二：在流量监测技术中，传统的机器学习方法需要人工提取特征，检测效果很大程度上依赖于特征的设计，而深度神经网络有效解决了这个问题。

第三：近年来，卷积神经网络CNN在图像识别，流量识别等领域展现出了巨大的潜力。使用CNN算法的流程大致为，从流量中提取原始特征，逐层学习抽象，得到高级流量特征，然后在输出层进行分类，得到分类结果。

第四：经过我们的初步实践，现今数据集普遍存在流量类型数量不均匀的问题，可能导致模型对部分攻击类型的训练程度不够，泛化能力不强，针对这一问题，通过良好训练的生成式对抗网络，可以生成与真实流量极其相似的网络流量，这样可以补充数量较少的流量种类，强化分类模型的泛化能力。

相关工作！

  1. 流量获取 ：流量 -> csv格式数据集 （抓包软件）
  2. 数据集预处理：csv格式数据集 -> numpy矩阵
  3. 神经网络判断：numpy矩阵 -> 神经元输出数据
  4. 数据可视化：神经元数据-> 柱状图等
  5. 图形界面：图片展示、按钮
     1. 流量基础信息展示
     2. 地区展示可视化
     3. 统计功能（应用、ip、
     4. 单次检测、批量检测（检测进度可视化）

- 神经网络训练流程 [链接：IDS-2017-Datasets-UNB](https://www.unb.ca/cic/datasets/ids-2017.html)
  1. 数据集预处理：csv格式数据集 -> numpy矩阵
  2. 神经网络训练

- 运行流程

  1. scapy流量获取 ：流量 -> csv格式数据集
     - pcap数据（以数据包为单位）处理成csv流量数据（以流量为单位）
  2. 数据集预处理：csv格式数据集 -> 矩阵
  3. 神经网络判断：矩阵 -> 神经元输出数据
  4. 数据可视化：神经元数据-> 柱状图等
     1. 测试数据集中各种流量的的分布：饼图/柱状图
     2. 单条流量可能所属类型：柱状图
  5. （重点）GUI：图片展示、按钮 [Introduction · PyQt5 中文教程](https://maicss.gitbooks.io/pyqt5/content/)
     1. 流量基础信息展示
     2. 单次检测、批量检测（检测进度可视化）
     3. ~~地区展示可视化~~
     4. 统计功能（应用、ip)

功能

- 实时获取流量，或者读取已有流量数据
- 对流量数据进行分类
- 展示分类结果
  - 若干条流量的种类分布
  - 某条流量的种类分布
- 展示流量基础数据
  - 流量概述
  - 数据包概述
  - ip地址可视化

实现原理

首先是神经网络内核的构建：利用2017数据集对CNN分类器进行训练，训练数据集中每条样本是以流为单位，输出结果是从属于某个流量类型的概率。
然后是获取实时流量：利用python的scapy提取pcap格式的流量数据，因为流量数据是离散的，需要整合成以流为单位的文件。
最后是用户界面的搭建：用户界面提供给用户手动选取流量的功能，并且能展示分析结果。

指标
    准确度指标：准确度指标一方面体现在测试集的准确率上，一方面可以模拟攻击，对分类器的效果进行验证。
    用户兴趣点：该软件面向的是专业人员，对检测具体细节和检测效果有一定要求

## 第三章 作品测试与分析

（建议包括测试方案、测试环境搭建、测试设备、测试数据、结果分析等）

## 第四章 创新性说明/可靠性（写作思路可以调整

（本部内容主要说明作品的创新性）

技术创新

其他方向的

时间上的创新

state of the art -- 主干论文

硕士论文

## 第五章 总结
